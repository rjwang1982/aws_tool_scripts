<!DOCTYPE html> <html style><!--
 Page saved with SingleFile 
 url: file:///private/var/folders/kj/d0dgchc979gbz791lcjbt_dh0000gn/T/crossnote2025111-25357-xebwgl.1vgo8.html 
 saved date: Mon Dec 01 2025 11:58:50 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
--><meta charset=utf-8>
<title>EBSå·æ ‡ç­¾ç®¡ç†è„šæœ¬ä½¿ç”¨æŒ‡å—</title>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<style>.katex .katex-version:after{content:"0.16.25"}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .eqn-num:before{content:"("counter(katexEqnNo)")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"("counter(mmlEqnNo)")";counter-increment:mmlEqnNo}body{counter-reset:katexEqnNo mmlEqnNo}</style>
<style>pre[class*=language-]{color:#333;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}.token.comment{color:#969896}.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator{color:#a71d5d}.token.string{color:#183691}.token.boolean,.token.number,.token.property{color:#0086b3}.token.class-name,.token.function{color:#795da3}.language-json .token.property{color:#183691}.language-bash .token.keyword{color:#0086b3}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;padding-bottom:.3em}html body h2{font-size:1.75em;padding-bottom:.3em}html body h3{font-size:1.5em}html body h4{font-size:1.25em}html body h1,html body h2,html body h3,html body h4{font-weight:600}html body strong{color:#000}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body ol,html body ul{padding-left:2em}html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox:hover{cursor:pointer}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body code{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:"Â "}html body pre>code{word-break:normal;white-space:pre;background:0 0}html body pre{border:#d6d6d6}html body pre code{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ol{list-style:decimal}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}.markdown-preview.markdown-preview{font-size:12px}</style>
<meta name=referrer content=no-referrer><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><body for=html-export>
 
 
 <div class="crossnote markdown-preview">
 
<h1 id=ebs-å·æ ‡ç­¾ç®¡ç†è„šæœ¬ä½¿ç”¨æŒ‡å—>EBS å·æ ‡ç­¾ç®¡ç†è„šæœ¬ä½¿ç”¨æŒ‡å— </h1>
<p><strong>ä½œè€…</strong>: RJ.Wang<br>
<strong>é‚®ç®±</strong>: <a href=mailto:wangrenjun@gmail.com>wangrenjun@gmail.com</a><br>
<strong>åˆ›å»ºæ—¶é—´</strong>: 2025-11-28<br>
<strong>AWS è´¦å·</strong>: Sungrow_EU (eu-central-1)</p>
<hr>
<h2 id=-éœ€æ±‚èƒŒæ™¯>ğŸ“‹ éœ€æ±‚èƒŒæ™¯ </h2>
<h3 id=é—®é¢˜æè¿°>é—®é¢˜æè¿° </h3>
<p>åœ¨ Sungrow_EU AWS è´¦å·çš„æ³•å…°å…‹ç¦åŒºåŸŸï¼ˆeu-central-1ï¼‰ä¸­ï¼š</p>
<ul>
<li>å…±æœ‰ 533 ä¸ª EBS å·</li>
<li>ä»… 39 ä¸ªå·æœ‰æ ‡ç­¾ï¼ˆ7.3%ï¼‰</li>
<li>494 ä¸ªå·æ²¡æœ‰æ ‡ç­¾ï¼ˆ92.7%ï¼‰</li>
</ul>
<h3 id=éœ€æ±‚ç›®æ ‡>éœ€æ±‚ç›®æ ‡ </h3>
<p>å°† EC2 å®ä¾‹çš„ Name æ ‡ç­¾è‡ªåŠ¨å¤åˆ¶åˆ°å…¶æŒ‚è½½çš„æ‰€æœ‰ EBS å·ä¸Šï¼Œä¾¿äºï¼š</p>
<ul>
<li>æˆæœ¬åˆ†é…å’Œè¿½è¸ª</li>
<li>èµ„æºç®¡ç†å’Œè¯†åˆ«</li>
<li>æ‰¹é‡æ“ä½œå’Œç­›é€‰</li>
</ul>
<hr>
<h2 id=ï¸-è§£å†³æ–¹æ¡ˆ>ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ </h2>
<h3 id=è„šæœ¬ä½ç½®>è„šæœ¬ä½ç½® </h3>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>~/Desktop/tag-ebs-volumes.sh
</code></pre><h3 id=è„šæœ¬åŠŸèƒ½>è„šæœ¬åŠŸèƒ½ </h3>
<ol>
<li>æ‰«ææŒ‡å®šåŒºåŸŸçš„æ‰€æœ‰ EC2 å®ä¾‹</li>
<li>è·å–æ¯ä¸ªå®ä¾‹çš„ Name æ ‡ç­¾</li>
<li>å°† Name æ ‡ç­¾å¤åˆ¶åˆ°è¯¥å®ä¾‹æŒ‚è½½çš„æ‰€æœ‰ EBS å·</li>
<li>æä¾›è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—å’Œç»Ÿè®¡ä¿¡æ¯</li>
</ol>
<hr>
<h2 id=-ä½¿ç”¨æ–¹æ³•>ğŸ“– ä½¿ç”¨æ–¹æ³• </h2>
<h3 id=åŸºæœ¬ç”¨æ³•>åŸºæœ¬ç”¨æ³• </h3>
<h4 id=1-é¢„è§ˆæ¨¡å¼æ¨èé¦–æ¬¡è¿è¡Œ>1. é¢„è§ˆæ¨¡å¼ï¼ˆæ¨èé¦–æ¬¡è¿è¡Œï¼‰ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1 --dry-run
</code></pre><p><strong>è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä¸ä¼šå®é™…ä¿®æ”¹ä»»ä½•æ ‡ç­¾</li>
<li>æ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„æ“ä½œ</li>
<li>ç”¨äºéªŒè¯è„šæœ¬é€»è¾‘</li>
</ul>
<h4 id=2-å®é™…æ‰§è¡Œ>2. å®é™…æ‰§è¡Œ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1
</code></pre><p><strong>è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å®é™…ä¿®æ”¹ EBS å·æ ‡ç­¾</li>
<li>æ˜¾ç¤ºè¯¦ç»†çš„æ‰§è¡Œè¿‡ç¨‹</li>
<li>è¾“å‡ºç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h3 id=å‚æ•°è¯´æ˜>å‚æ•°è¯´æ˜ </h3>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å¿…éœ€</th>
<th>é»˜è®¤å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--profile</code></td>
<td>æ˜¯</td>
<td>æ— </td>
<td>AWS CLI profile åç§°</td>
</tr>
<tr>
<td><code>--region</code></td>
<td>æ˜¯</td>
<td>æ— </td>
<td>AWS åŒºåŸŸï¼ˆå¦‚ eu-central-1ï¼‰</td>
</tr>
<tr>
<td><code>--dry-run</code></td>
<td>å¦</td>
<td>false</td>
<td>é¢„è§ˆæ¨¡å¼ï¼Œä¸å®é™…æ‰§è¡Œ</td>
</tr>
</tbody>
</table>
<hr>
<h2 id=-å·¥ä½œåŸç†>ğŸ” å·¥ä½œåŸç† </h2>
<h3 id=æ‰§è¡Œæµç¨‹>æ‰§è¡Œæµç¨‹ </h3>
<pre data-role=codeBlock data-info class=language-text><code>1. å‚æ•°éªŒè¯
   â†“
2. è·å–æ‰€æœ‰ EC2 å®ä¾‹åˆ—è¡¨
   â†“
3. éå†æ¯ä¸ªå®ä¾‹
   â”œâ”€ è·å–å®ä¾‹ Name æ ‡ç­¾
   â”œâ”€ è·å–æŒ‚è½½çš„ EBS å·åˆ—è¡¨
   â””â”€ ä¸ºæ¯ä¸ªå·æ·»åŠ  Name æ ‡ç­¾
   â†“
4. è¾“å‡ºç»Ÿè®¡ä¿¡æ¯
</code></pre><h3 id=è¯¦ç»†æ­¥éª¤>è¯¦ç»†æ­¥éª¤ </h3>
<h4 id=æ­¥éª¤-1-è·å–å®ä¾‹åˆ—è¡¨>æ­¥éª¤ 1: è·å–å®ä¾‹åˆ—è¡¨ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws ec2 describe-instances <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> sungrow_eu <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> eu-central-1 <span class="token punctuation">\</span>
  <span class="token parameter variable">--query</span> <span class="token string">'Reservations[].Instances[].[InstanceId,Tags[?Key==`Name`].Value|[0]]'</span>
</code></pre><p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre data-role=codeBlock data-info class=language-text><code>i-0abc123def456789  eks-node-prod-01
i-0def456abc789012  eks-node-prod-02
</code></pre><h4 id=æ­¥éª¤-2-è·å–æŒ‚è½½çš„å·>æ­¥éª¤ 2: è·å–æŒ‚è½½çš„å· </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws ec2 describe-volumes <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> sungrow_eu <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> eu-central-1 <span class="token punctuation">\</span>
  <span class="token parameter variable">--filters</span> <span class="token string">"Name=attachment.instance-id,Values=i-0abc123def456789"</span>
</code></pre><p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre data-role=codeBlock data-info=json class="language-json json"><code><span class="token punctuation">{</span>
  <span class="token property">"Volumes"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"VolumeId"</span><span class="token operator">:</span> <span class="token string">"vol-0123456789abcdef0"</span><span class="token punctuation">,</span>
      <span class="token property">"Attachments"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">"InstanceId"</span><span class="token operator">:</span> <span class="token string">"i-0abc123def456789"</span><span class="token punctuation">,</span>
          <span class="token property">"Device"</span><span class="token operator">:</span> <span class="token string">"/dev/xvda"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><h4 id=æ­¥éª¤-3-æ·»åŠ æ ‡ç­¾>æ­¥éª¤ 3: æ·»åŠ æ ‡ç­¾ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws ec2 create-tags <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> sungrow_eu <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> eu-central-1 <span class="token punctuation">\</span>
  <span class="token parameter variable">--resources</span> vol-0123456789abcdef0 <span class="token punctuation">\</span>
  <span class="token parameter variable">--tags</span> <span class="token assign-left variable">Key</span><span class="token operator">=</span>Name,Value<span class="token operator">=</span>eks-node-prod-01
</code></pre><hr>
<h2 id=-è¾“å‡ºç¤ºä¾‹>ğŸ“Š è¾“å‡ºç¤ºä¾‹ </h2>
<h3 id=é¢„è§ˆæ¨¡å¼è¾“å‡º>é¢„è§ˆæ¨¡å¼è¾“å‡º </h3>
<pre data-role=codeBlock data-info class=language-text><code>========================================
EBS Volume Tagging Script
========================================
Profile: sungrow_eu
Region: eu-central-1
Mode: DRY RUN (Preview Only)
========================================

Processing instance: i-0abc123def456789 (eks-node-prod-01)
  [DRY RUN] Would tag volume vol-0123456789abcdef0 with Name=eks-node-prod-01
  [DRY RUN] Would tag volume vol-0234567890abcdef1 with Name=eks-node-prod-01

Processing instance: i-0def456abc789012 (eks-node-prod-02)
  [DRY RUN] Would tag volume vol-0345678901abcdef2 with Name=eks-node-prod-02

========================================
Summary
========================================
Total instances processed: 2
Total volumes tagged: 3
========================================
</code></pre><h3 id=å®é™…æ‰§è¡Œè¾“å‡º>å®é™…æ‰§è¡Œè¾“å‡º </h3>
<pre data-role=codeBlock data-info class=language-text><code>========================================
EBS Volume Tagging Script
========================================
Profile: sungrow_eu
Region: eu-central-1
Mode: LIVE (Making Changes)
========================================

Processing instance: i-0abc123def456789 (eks-node-prod-01)
  âœ“ Tagged volume vol-0123456789abcdef0 with Name=eks-node-prod-01
  âœ“ Tagged volume vol-0234567890abcdef1 with Name=eks-node-prod-01

Processing instance: i-0def456abc789012 (eks-node-prod-02)
  âœ“ Tagged volume vol-0345678901abcdef2 with Name=eks-node-prod-02

========================================
Summary
========================================
Total instances processed: 2
Total volumes tagged: 3
========================================
</code></pre><hr>
<h2 id=ï¸-æ³¨æ„äº‹é¡¹>âš ï¸ æ³¨æ„äº‹é¡¹ </h2>
<h3 id=æ‰§è¡Œå‰æ£€æŸ¥>æ‰§è¡Œå‰æ£€æŸ¥ </h3>
<ol>
<li>
<p><strong>éªŒè¯ AWS å‡­è¯</strong></p>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws <span class="token parameter variable">--profile</span> sungrow_eu sts get-caller-identity
</code></pre></li>
<li>
<p><strong>ç¡®è®¤æƒé™</strong><br>
éœ€è¦ä»¥ä¸‹ IAM æƒé™ï¼š</p>
<ul>
<li><code>ec2:DescribeInstances</code></li>
<li><code>ec2:DescribeVolumes</code></li>
<li><code>ec2:CreateTags</code></li>
</ul>
</li>
<li>
<p><strong>å…ˆè¿è¡Œé¢„è§ˆæ¨¡å¼</strong></p>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1 --dry-run
</code></pre></li>
</ol>
<h3 id=å®‰å…¨è€ƒè™‘>å®‰å…¨è€ƒè™‘ </h3>
<ul>
<li>è„šæœ¬åªæ·»åŠ  Name æ ‡ç­¾ï¼Œä¸ä¼šåˆ é™¤æˆ–ä¿®æ”¹å…¶ä»–æ ‡ç­¾</li>
<li>ä¸ä¼šå½±å“ EBS å·çš„æ•°æ®æˆ–é…ç½®</li>
<li>ä¸ä¼šå½±å“ EC2 å®ä¾‹çš„è¿è¡ŒçŠ¶æ€</li>
</ul>
<h3 id=å¹‚ç­‰æ€§>å¹‚ç­‰æ€§ </h3>
<ul>
<li>è„šæœ¬å¯ä»¥å®‰å…¨åœ°å¤šæ¬¡è¿è¡Œ</li>
<li>å·²æœ‰ Name æ ‡ç­¾çš„å·ä¼šè¢«æ›´æ–°ä¸ºæœ€æ–°å€¼</li>
<li>ä¸ä¼šäº§ç”Ÿé‡å¤æ ‡ç­¾</li>
</ul>
<hr>
<h2 id=-å®é™…åº”ç”¨åœºæ™¯>ğŸ¯ å®é™…åº”ç”¨åœºæ™¯ </h2>
<h3 id=åœºæ™¯-1-åˆæ¬¡æ ‡ç­¾åŒ–>åœºæ™¯ 1: åˆæ¬¡æ ‡ç­¾åŒ– </h3>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token comment"># 1. é¢„è§ˆå°†è¦æ‰§è¡Œçš„æ“ä½œ</span>
<span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1 --dry-run

<span class="token comment"># 2. ç¡®è®¤æ— è¯¯åæ‰§è¡Œ</span>
<span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1
</code></pre><h3 id=åœºæ™¯-2-å®šæœŸåŒæ­¥>åœºæ™¯ 2: å®šæœŸåŒæ­¥ </h3>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token comment"># æ¯å‘¨è¿è¡Œä¸€æ¬¡ï¼Œç¡®ä¿æ–°åˆ›å»ºçš„å·ä¹Ÿè¢«æ ‡è®°</span>
<span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1
</code></pre><h3 id=åœºæ™¯-3-éªŒè¯ç»“æœ>åœºæ™¯ 3: éªŒè¯ç»“æœ </h3>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token comment"># æ£€æŸ¥æ ‡ç­¾ç»Ÿè®¡</span>
aws ec2 describe-volumes <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> sungrow_eu <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> eu-central-1 <span class="token punctuation">\</span>
  <span class="token parameter variable">--query</span> <span class="token string">'Volumes[?Tags[?Key==`Name`]].VolumeId'</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--output</span> text <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span>
</code></pre><hr>
<h2 id=-é¢„æœŸæ•ˆæœ>ğŸ“ˆ é¢„æœŸæ•ˆæœ </h2>
<h3 id=æ‰§è¡Œå‰>æ‰§è¡Œå‰ </h3>
<ul>
<li>æœ‰æ ‡ç­¾çš„å·: 39 (7.3%)</li>
<li>æ— æ ‡ç­¾çš„å·: 494 (92.7%)</li>
</ul>
<h3 id=æ‰§è¡Œå>æ‰§è¡Œå </h3>
<ul>
<li>æ‰€æœ‰æŒ‚è½½åˆ°æœ‰ Name æ ‡ç­¾çš„ EC2 å®ä¾‹çš„å·éƒ½ä¼šè¢«æ ‡è®°</li>
<li>ä¾¿äºåœ¨ AWS Console ä¸­æŒ‰ Name ç­›é€‰å’Œæœç´¢</li>
<li>æˆæœ¬æŠ¥å‘Šä¸­å¯ä»¥æŒ‰ Name æ ‡ç­¾åˆ†ç»„</li>
</ul>
<hr>
<h2 id=-æ•…éšœæ’æŸ¥>ğŸ”§ æ•…éšœæ’æŸ¥ </h2>
<h3 id=é—®é¢˜-1-æƒé™ä¸è¶³>é—®é¢˜ 1: æƒé™ä¸è¶³ </h3>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre data-role=codeBlock data-info class=language-text><code>An error occurred (UnauthorizedOperation) when calling the CreateTags operation
</code></pre><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š<br>
ç¡®ä¿ IAM ç”¨æˆ·/è§’è‰²æœ‰ <code>ec2:CreateTags</code> æƒé™</p>
<h3 id=é—®é¢˜-2-å®ä¾‹æ²¡æœ‰-name-æ ‡ç­¾>é—®é¢˜ 2: å®ä¾‹æ²¡æœ‰ Name æ ‡ç­¾ </h3>
<p><strong>ç°è±¡</strong>ï¼š<br>
æŸäº›å®ä¾‹è¢«è·³è¿‡</p>
<p><strong>è¯´æ˜</strong>ï¼š<br>
è„šæœ¬åªå¤„ç†æœ‰ Name æ ‡ç­¾çš„å®ä¾‹ï¼Œè¿™æ˜¯æ­£å¸¸è¡Œä¸º</p>
<h3 id=é—®é¢˜-3-å·æ²¡æœ‰è¢«æ ‡è®°>é—®é¢˜ 3: å·æ²¡æœ‰è¢«æ ‡è®° </h3>
<p><strong>æ£€æŸ¥æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>ç¡®è®¤å·æ˜¯å¦æŒ‚è½½åˆ°å®ä¾‹</li>
<li>ç¡®è®¤å®ä¾‹æ˜¯å¦æœ‰ Name æ ‡ç­¾</li>
<li>æ£€æŸ¥ AWS CLI è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯</li>
</ol>
<hr>
<h2 id=-è„šæœ¬æ ¸å¿ƒé€»è¾‘>ğŸ“ è„šæœ¬æ ¸å¿ƒé€»è¾‘ </h2>
<h3 id=å…³é”®ä»£ç ç‰‡æ®µ>å…³é”®ä»£ç ç‰‡æ®µ </h3>
<h4 id=1-è·å–å®ä¾‹å’Œæ ‡ç­¾>1. è·å–å®ä¾‹å’Œæ ‡ç­¾ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws ec2 describe-instances <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> <span class="token string">"<span class="token variable">$PROFILE</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> <span class="token string">"<span class="token variable">$REGION</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--query</span> <span class="token string">'Reservations[].Instances[].[InstanceId,Tags[?Key==`Name`].Value|[0]]'</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--output</span> text
</code></pre><h4 id=2-è·å–æŒ‚è½½çš„å·>2. è·å–æŒ‚è½½çš„å· </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code>aws ec2 describe-volumes <span class="token punctuation">\</span>
  <span class="token parameter variable">--profile</span> <span class="token string">"<span class="token variable">$PROFILE</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--region</span> <span class="token string">"<span class="token variable">$REGION</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--filters</span> <span class="token string">"Name=attachment.instance-id,Values=<span class="token variable">$instance_id</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--query</span> <span class="token string">'Volumes[].VolumeId'</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--output</span> text
</code></pre><h4 id=3-æ·»åŠ æ ‡ç­¾>3. æ·»åŠ æ ‡ç­¾ </h4>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token keyword keyword-if">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$DRY_RUN</span>"</span> <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword keyword-then">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">"  [DRY RUN] Would tag volume <span class="token variable">$volume_id</span> with Name=<span class="token variable">$instance_name</span>"</span>
<span class="token keyword keyword-else">else</span>
  aws ec2 create-tags <span class="token punctuation">\</span>
    <span class="token parameter variable">--profile</span> <span class="token string">"<span class="token variable">$PROFILE</span>"</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--region</span> <span class="token string">"<span class="token variable">$REGION</span>"</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--resources</span> <span class="token string">"<span class="token variable">$volume_id</span>"</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--tags</span> <span class="token string">"Key=Name,Value=<span class="token variable">$instance_name</span>"</span>
  <span class="token builtin class-name">echo</span> <span class="token string">"  âœ“ Tagged volume <span class="token variable">$volume_id</span> with Name=<span class="token variable">$instance_name</span>"</span>
<span class="token keyword keyword-fi">fi</span>
</code></pre><hr>
<h2 id=-æ‰©å±•å»ºè®®>ğŸš€ æ‰©å±•å»ºè®® </h2>
<h3 id=åŠŸèƒ½æ‰©å±•>åŠŸèƒ½æ‰©å±• </h3>
<ol>
<li>
<p><strong>æ”¯æŒå¤šä¸ªæ ‡ç­¾</strong></p>
<ul>
<li>ä¸ä»…å¤åˆ¶ Nameï¼Œè¿˜å¯ä»¥å¤åˆ¶ Environmentã€Project ç­‰æ ‡ç­¾</li>
</ul>
</li>
<li>
<p><strong>æ”¯æŒå¤šåŒºåŸŸ</strong></p>
<ul>
<li>å¾ªç¯å¤„ç†å¤šä¸ª AWS åŒºåŸŸ</li>
</ul>
</li>
<li>
<p><strong>ç”ŸæˆæŠ¥å‘Š</strong></p>
<ul>
<li>è¾“å‡º CSV æˆ– JSON æ ¼å¼çš„è¯¦ç»†æŠ¥å‘Š</li>
</ul>
</li>
<li>
<p><strong>é”™è¯¯é‡è¯•</strong></p>
<ul>
<li>æ·»åŠ å¤±è´¥é‡è¯•æœºåˆ¶</li>
</ul>
</li>
</ol>
<h3 id=è‡ªåŠ¨åŒ–é›†æˆ>è‡ªåŠ¨åŒ–é›†æˆ </h3>
<pre data-role=codeBlock data-info=bash class="language-bash bash"><code><span class="token comment"># æ·»åŠ åˆ° crontabï¼Œæ¯å‘¨æ—¥å‡Œæ™¨ 2 ç‚¹æ‰§è¡Œ</span>
<span class="token number">0</span> <span class="token number">2</span> * * <span class="token number">0</span> <span class="token function">bash</span> ~/Desktop/tag-ebs-volumes.sh <span class="token parameter variable">--profile</span> sungrow_eu <span class="token parameter variable">--region</span> eu-central-1 <span class="token operator">&gt;&gt;</span> /var/log/ebs-tagging.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre><hr>
<h2 id=-ç›¸å…³èµ„æº>ğŸ“š ç›¸å…³èµ„æº </h2>
<h3 id=aws-cli-æ–‡æ¡£>AWS CLI æ–‡æ¡£ </h3>
<ul>
<li><a href=https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html>describe-instances</a></li>
<li><a href=https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-volumes.html>describe-volumes</a></li>
<li><a href=https://docs.aws.amazon.com/cli/latest/reference/ec2/create-tags.html>create-tags</a></li>
</ul>
<h3 id=æœ€ä½³å®è·µ>æœ€ä½³å®è·µ </h3>
<ul>
<li><a href=https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html>AWS èµ„æºæ ‡ç­¾ç­–ç•¥</a></li>
<li><a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes.html>EBS å·ç®¡ç†</a></li>
</ul>
<hr>
<h2 id=-æ€»ç»“>âœ… æ€»ç»“ </h2>
<h3 id=è„šæœ¬ä¼˜åŠ¿>è„šæœ¬ä¼˜åŠ¿ </h3>
<ul>
<li>âœ… è‡ªåŠ¨åŒ–æ ‡ç­¾ç®¡ç†ï¼ŒèŠ‚çœäººå·¥æ—¶é—´</li>
<li>âœ… æ”¯æŒé¢„è§ˆæ¨¡å¼ï¼Œå®‰å…¨å¯é </li>
<li>âœ… è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—ï¼Œä¾¿äºå®¡è®¡</li>
<li>âœ… å¹‚ç­‰æ€§è®¾è®¡ï¼Œå¯é‡å¤æ‰§è¡Œ</li>
</ul>
<h3 id=ä½¿ç”¨å»ºè®®>ä½¿ç”¨å»ºè®® </h3>
<ol>
<li>é¦–æ¬¡ä½¿ç”¨å…ˆè¿è¡Œ <code>--dry-run</code> æ¨¡å¼</li>
<li>å®šæœŸæ‰§è¡Œä»¥ä¿æŒæ ‡ç­¾åŒæ­¥</li>
<li>ç»“åˆ AWS Cost Explorer è¿›è¡Œæˆæœ¬åˆ†æ</li>
<li>è€ƒè™‘å°†è„šæœ¬åŠ å…¥è‡ªåŠ¨åŒ–æµç¨‹</li>
</ol>
<hr>
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>: 1.0<br>
<strong>æœ€åæ›´æ–°</strong>: 2025-11-28<br>
<strong>ç»´æŠ¤è€…</strong>: RJ.Wang (<a href=mailto:wangrenjun@gmail.com>wangrenjun@gmail.com</a>)</p>
 </div>
 
 
 
 
 
 
 
 
 